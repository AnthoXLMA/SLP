<% if @meeting_number %>
<script>
init_zoom = function () {
ZoomMtg.init({
  disablePreview: true,
  leaveUrl: '<%= @meeting_leave_url %>',
  showMeetingHeader: false,
  disableInvite: true,
  disableCallOut: true,
  disableRecord: true,
  disableJoinAudio: true,
  isSupportAV: true,
  screenShare: false,
  videoHeader: false,
  isLockBottom: false,
  // on success, call the join method
  success: function() {	
    console.log("Joining meeting");
    ZoomMtg.join({
      // pass your signature response in the join method
      signature: '<%= @signature %>',
      apiKey: '<%= @api_key %>',
      meetingNumber: '<%= @meeting_number %>',
      userName: '<%= @user_name %>',
      userEmail: '<%= @user_email %>',
      passWord: '<%= @meeting_password %>',
      success: function (res) {
        console.log("join meeting success");
        console.log("get attendeelist");
        ZoomMtg.getAttendeeslist({});
        ZoomMtg.getCurrentUser({
          success: function (res) {
            console.log("success getCurrentUser", res.result.currentUser);
          },
        });
        //ZoomMtg.showJoinAudioFunction({show: false});
      },
      error(res) { 
        console.log(res) 
      }
    });
  },
  error(res) {
      console.log("Failed to initialize", res);
  } 
});
}
</script>
<% end %>